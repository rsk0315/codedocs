% 貪欲法

何かしらを最適化する問題を考える．
$i$ 番目に何かを行うとき，$i+1$ 番目以降のことは考慮せずに，その場での最適行動を取ることを貪欲法と呼ぶ．

ある評価関数に基づいて対象を並べ替え，その評価値の高い方から順に操作すると見ることもできる．

## 貪欲法で解ける問題の例

### 合計の最大化

配列 $a[0\ldots n-1]$ からちょうど $k$ 個選び，その合計を最大化したい．

これは，$a[i]$ を大きい方から順に並べ，先頭の $k$ 個を選ぶのがよい．

### 累積和の合計の最大化

配列 $a[0\ldots n-1]$ を並べ替え，$\sum_{i=0}^{n-1} \sum_{j=0}^i a[j]$ を最大化したい．

これも，$a[i]$ を大きい方から順に並べるのがよい．

### 重みつき平均

配列 $a[0\ldots n-1]$ と各要素の重み $w[0\ldots n-1]$ が与えられる．
ここから $k$ 個選んだときの重みつき平均であって，$x$ 以上になるものを作りたい．

選ぶ要素の添字集合を $I$ とすると，上の条件は次のように表せる．
$$\frac{\sum_{i\in I} a[i]\cdot w[i]}{\sum_{i\in I} w[i]} \ge x.$$
すなわち，次のようになる．
$$\sum_{i\in I}(a[i]-x)\cdot w[i] \ge 0.$$
よって，$(a[i]-x)\cdot w[i]$ が大きい方から順に $k$ 個選ぶのがよい．

$k$ 個選ぶときの重みつき平均の最大化は，これを判定問題として二分探索を行うことで解ける．

### 区間スケジューリング

図を貼る．

終端でソートする．

### 和でソート

$(a_i, b_i)$ と $(a_j, b_j)$ を比較したとき，$a_j-b_i$ と $a_i-b_j$ の大きい方から優先して選びたいとする．

これは，$a_j-b_i \lesseqgtr a_i-b_j \iff a_j+b_j \lesseqgtr a_i+b_i$ より，$a_i+b_i$ でソートするとよい．

$\min(a_i, a_j-b_i)$ と $\min(a_j, a_i-b_j)$ の大きい方から優先して選びたいときも $a_i+b_i$ でソートするといいらしい (???)．

## 証明の定石

https://inzkyk.github.io/algorithms/greedy_algorithm/

貪欲法ではない最適解の存在を仮定し，それらの解で異なる部分を持ってくる．
貪欲法で用いた評価関数に対して逆転している対を持ってくると考えるとよさそう？

そうした部分を交換し，貪欲な選び方をしても解が真に悪くならないことを示せばよい．

## 発展的な話題

マトロイドを調べてみよう．
