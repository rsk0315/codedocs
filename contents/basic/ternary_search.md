% 三分探索

凸関数 $f: A\to A$ の最適化を行う．以下では，便宜上 $x^\* = \arg\min_x f(x)$ を求めるとする．

図があるとわかりやすいはずなので，図を貼る．

二分探索同様，最適解 $x^\*$ を含むような領域 $[x_{\mathrm{LB}}, x_{\mathrm{UB}})\ni x^\*$ を用意する．

$x_{\mathrm{M0}}$, $x_{\mathrm{M1}}$ ($x_{\mathrm{LB}} < x_{\mathrm{M0}} < x_{\mathrm{M1}} < x_{\mathrm{UB}}$) を用意し，$f(x_{\mathrm{M0}})$, $f(x_{\mathrm{M1}})$ の大小関係によって領域を更新する．

どのように更新されるかは，図を貼った後に追記する．

単純な実装では，$1:2$ および $2:1$ に内分する点を $x_{\mathrm{M0}}$, $x_{\mathrm{M1}}$ として採用する．

黄金比 $\phi$ を用いて $\phi:1$ および $1:\phi$ に内分する点を採用すると，一度計算した $f$ をその後のステップで使い回すことができ，効率がよくなりうる．

実数上で二分探索をするとき同様，ループ回数を決め打ちするのがよい．
初期の区間幅を $\Delta x$，目標の幅を $\epsilon$ とし，$1:w$ および $w:1$ ($1 < w$) の内分点を用いるとする（解析の簡単のため，内分点は対称に取る）．

一回のループで区間は $w/(1+w)$ 倍に縮むので，$\log_{1+(1/w)} (\Delta x/\epsilon)$ 回のループで求められる．$w$ は小さい方がよさそうに見える．

$2 > \phi$ であるので，以下 $w = \phi$ として考える．
最初に二回 $f$ を評価した後，各ステップでは一回ずつしか $f$ を評価しないので，
$\log_{\phi}(\Delta x/\epsilon)+1$ 回の評価を行う．$1+(1/\phi) = \phi$ に注意．

$\Delta x = 10^{18}$, $\epsilon = 10^{-9}$ としたとき，ループ回数は $\lceil 129.19\ldots\rceil = 130$ 回となる．

ところで，$w\to 1$ のとき，ループ回数は $\lceil 89.69\ldots\rceil = 90$ 回で最小になると思われる．
しかし，$f$ の使い回しができないため，$180$ 回 $f$ を評価することになってしまい，これは $\phi$ を使う場合よりもよくない．

---

$f$ の定義域が離散の場合を考える．
$\cdots > f(x^\*-1) > f(x^\*) < f(x^\*+1) < \cdots$ となるが，これは以下のように書き換えられる．
- $f(x^\*-1) - f(x^\*) > 0$
- $f(x^\*) - f(x^\*+1) < 0$

すなわち，$P(x) \iff f(x)-f(x+1) > 0$ として二分探索を行うことで求められる．

上の議論から，評価回数では $\phi$ を使うよりは損をしていそう？ 一方で，分割点を求めるときに除算の代わりにシフト演算でできてうれしそう？
誤差に関する議論を無視できるのが一番うれしそう．

---

平坦な領域があるような関数では大域的最適解が求まるとは限らないので注意が必要そう．
