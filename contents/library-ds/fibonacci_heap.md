% フィボナッチヒープ

半順序集合 $(T, \le)$ に対する優先度つきキューを考える．すなわち，以下の基本演算を行える．

- $\mathtt{top}()$
  - 極大要素を返す．
- $\mathtt{push}(x)$
  - キューに $x$ を追加する．
- $\mathtt{pop}()$
  - 極大要素を一つ取り除く．

Fibonacci heap では，これに加えて以下の操作を行える．

- $\mathtt{meld}(q)$
  - 別の Fibonacci heap $q$ と併合する．
- $\mathtt{prioritize}(x, y)$
  - 要素 $x$ を $y$ ($y \le x$) に変更する．
  - ただし，$x$ はイテレータのようなもので指定する．

計算量は以下の通り．ただし，$n$ はキュー中の要素数とし，${}^*$ はならし計算量とする．

| 演算 | 計算量 |
| --- | --- |
| `top` | $O(1)$ |
| `push` | $O(1)$ |
| `pop` | $O(\log n)^*$ |
| `meld` | $O(1)$ |
| `prioritize` | $O(1)^*$ |

---

これを用いると，グラフ $G = (V, E)$ に対する Dijkstra 法や Prim 法において，キュー中の要素数をたかだか $|V|$ にできる．
そのため，`pop` の回数を $O(|V|)$ 回に減らせて，$O(|E|+|V|\log|V|)$ time で実行できる．
